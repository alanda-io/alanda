<p-table
  class="attachment-list"
  [value]="currentFiles"
  [scrollable]="true"
  scrollHeight="320px"
  autoLayout="true"
  dataKey="guid"
>
  <!-- 'let-columns' allows access to the ng-template context columns property-->
  <ng-template pTemplate="header">
    <tr>
      <th>Name</th>
      <th>Last Modified</th>
      <th>Size</th>
      <th>Action</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-file>
    <tr>
      <td>
        {{ file.name }}
      </td>
      <td>
        {{ file.lastModified | date: 'd MMMM y' }}
      </td>
      <td>{{ file.size }} KB</td>
      <td>
        <ng-container *ngSwitchCase="'action'">
          <!-- Download file -->
          <a [href]="download(file.guid)" class="file-action-button"
            ><i class="pi pi-download"></i
          ></a>

          <!-- File Preview -->
          <ng-container *ngIf="previewAllowed(file.name)">
            <ng-template
              [ngIf]="!file.name.endsWith('.pdf')"
              [ngIfElse]="pdfPreview"
            >
              <p-lightbox class="lightbox" type="content">
                <a href="#" class="file-action-button">
                  <i class="pi pi-image"></i>
                </a>
                <img
                  [src]="download(file.guid)"
                  alt="file.name"
                  style="margin: auto; height: 100%; width: 100%;"
                />
              </p-lightbox>
            </ng-template>
            <ng-template #pdfPreview>
              <p-lightbox class="lightbox" type="content">
                <a href="#" class="file-action-button">
                  <i class="pi pi-image"></i>
                </a>
                <iframe
                  [src]="
                    sanitizer.bypassSecurityTrustResourceUrl(
                      download(file.guid)
                    )
                  "
                  style="width: 1000px; min-height: 400px;"
                ></iframe>
              </p-lightbox>
            </ng-template>
          </ng-container>

          <!-- Remove file -->
          <a
            class="file-action-button"
            (click)="onDeleteFile(file)"
            href="JavaScript:void(0)"
            ><i class="pi pi-trash"></i>
          </a>
        </ng-container>
      </td>
    </tr>
  </ng-template>
</p-table>
