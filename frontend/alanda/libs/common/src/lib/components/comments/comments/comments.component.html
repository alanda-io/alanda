<p-panel
  class="comments"
  [toggleable]="true"
  *ngIf="cp.filteredComments$ | push as comments"
>
  <p-header>
    <span class="ui-panel-title">
      Comments
      <alanda-badge label="{{ comments.length }}"></alanda-badge>
    </span>
  </p-header>

  <div class="p-grid">
    <div class="p-lg-10 p-sm-12">
      <form
        [formGroup]="cp.commentForm"
        (ngSubmit)="cp.commentFormSubmit$.next()"
      >
        <textarea
          pInputTextarea
          id="textarea"
          class="comment-textarea"
          [rows]="4"
          formControlName="comment"
          autoResize="autoResize"
          maxLength="4000"
          placeholder="Write a comment..."
        ></textarea>
        <div class="form-buttons">
          <p-button
            type="submit"
            icon="fa fa-paper-plane"
            iconPos="left"
            label="Post Comment"
            [disabled]="!cp.commentForm.valid"
          ></p-button>
        </div>
      </form>
      <p-scrollPanel
        [style]="{ height: '500px' }"
        *ngIf="comments.length > 0; else elseBlock"
      >
        <alanda-comment
          class="comment"
          [comment]="comment"
          [type]="'comment'"
          (submitReply)="cp.replyPostBody$.next($event)"
          (toggleFilterClick)="cp.toggleTagFilter($event)"
          [activeTagFilters]="cp.activeTagFilters$"
          *ngFor="let comment of comments; trackBy: cp.trackByCommentId"
        ></alanda-comment>
      </p-scrollPanel>
      <ng-template #elseBlock>
        <div class="comments-no-entry">
          Sorry there are not comments!
        </div>
      </ng-template>
    </div>
    <div class="p-col">
      <form [formGroup]="cp.commentFilterForm">
        <input
          formControlName="searchText"
          pInputText
          placeholder="Search comments"
        />
      </form>
      <div
        *ngFor="let tag of cp.tags$ | push; trackBy: cp.trackByTagId"
        class="tag-wrapper"
      >
        <alanda-comment-tag
          [isActive]="(cp.activeTagFilters$ | push)[tag.name]"
          [tag]="tag"
          (toggleFilterClick)="cp.toggleTagFilter(tag)"
        >
        </alanda-comment-tag>
      </div>
      <div class="tag-wrapper">
        <p-button
          label="Clear Tag Filters"
          icon="pi pi-times-circle"
          iconPos="left"
          type="button"
          (onClick)="cp.clearAllTagFilters()"
          *ngIf="cp.hasActiveFilters$ | push"
          styleClass="ui-button-danger"
        ></p-button>
      </div>
    </div>
  </div>
</p-panel>
